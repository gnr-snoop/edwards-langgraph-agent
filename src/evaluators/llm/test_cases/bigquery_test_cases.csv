ID,Pregunta,Respuesta,Thread_id

1,"quién tiene mas hallazgos cargados?","SELECT u.first_name, u.last_name, COUNT(t.id) AS hallazgos_cargados FROM user u JOIN reported_by r ON u.id= r.user_id GROUP BY u.id, u.first_name, u.last_name ORDER BY hallazgos_cargados DESC LIMIT 1;","1"
2,"decime los hallazgos cargados en los ultimos 4 meses","SELECT id, name, tipo_hallazgo, description, fecha_alta FROM task  WHERE fecha_alta >= DATE_SUB(CURRENT_DATE(), INTERVAL 4 MONTH)  ORDER BY fecha_alta DESC","2"
3,"cuantos hubo?","SELECT COUNT(*) FROM task WHERE fecha_alta >= DATE_SUB(CURRENT_DATE(), INTERVAL 4 MONTH)","2"
4,"y cerradas?","SELECT COUNT(*) FROM task WHERE status = 'cerrado' AND fecha_alta >= DATE_SUB(CURRENT_DATE(), INTERVAL 4 MONTH)","2"
5,"cuántas oportunidades de mejora fueron asignadas a Valentina Gonzalez?","SELECT COUNT(*) FROM assigned_to JOIN user ON user.id = assigned_to.user_id JOIN task ON task.id = assigned_to.task_id WHERE user.first_name = 'Yolanda Valentina' AND user.last_name = 'Gonzalez Dominguez'","3"
6,"cantidad de tareas cerradas del área QMO","SELECT COUNT(*) FROM task WHERE status = 'cerrado' AND areas = 'QMO'","4"
7,"mostrar el usuario con mas tareas cerradas del area sistemas internos","SELECT user.id, user.first_name, user.last_name, COUNT(task.id) AS closed_task  FROM user  JOIN assigned_to ON user.id= assigned_to.user_id  JOIN task ON assigned_to.task_id =task.id WHERE task.status = 'cerrado' AND task.areas = 'Sistemas Internos'GROUP BY user.id, user.first_name, user.last_name ORDER BY closed_task DESC  LIMIT 1;","5"
8,"mostrar usuarios que tengan mas tareas asignadas que reportadas","SELECT u.id, u.first_name, u.last_name, COUNT(DISTINCT assigned_to.task_id) AS assigned_tasks, COUNT(DISTINCT reported_by.task_id) AS reported_tasks FROM user u LEFT JOIN assigned_to ON u.id = assigned_to.user_id LEFT JOIN reported_by ON u.id = reported_by.user_id GROUP BY u.id, u.first_name, u.last_name HAVING COUNT(DISTINCT assigned_to.task_id) > COUNT(DISTINCT reported_by.task_id) ORDER BY assigned_tasks DESC;","6"
9,"mostrar la cantidad de tareas reportadas por el segundo usuario antes mencionado","SELECT COUNT(reported_by.task_id) AS reported_task_count FROM reported_by JOIN user ON reported_by.user_id = user.id WHERE user.first_name = 'Nicolas' AND user.last_name = 'Ezequiel Giannici';","6"
10,"Cuales son los 3 usuarios con más hallazgos cargados?","SELECT u.first_name, u.last_name, COUNT(t.id) AS cantidad_hallazgos FROM user u JOIN reported_by r ON u.id = r.user_id JOIN task t ON r.task_id = t.id GROUP BY u.id, u.first_name, u.last_name ORDER BY cantidad_hallazgos DESC LIMIT 3","7"
11,"Y los 3 siguientes?","SELECT u.first_name, u.last_name, COUNT(t.id) AS hallazgos_cargados FROM user u JOIN reported_by r ON u.id = r.user_id JOIN task t ON r.task_id = t.id GROUP BY u.id, u.first_name, u.last_name ORDER BY hallazgos_cargados DESC LIMIT 3 OFFSET 3;","7"
12,"Cuantos hallazgos creados suman las 5 personas que más hallazgos tienen creados?","SELECT COUNT(*) AS total_hallazgos FROM ( SELECT user_id, COUNT(*) AS hallazgos_count FROM reported_by GROUP BY user_id ORDER BY hallazgos_count DESC LIMIT 5) AS top_users JOIN reported_by ON top_users.user_id = reported_by.user_id","8"
13,"Cual es el promedio de hallazgos cargados por usuario?","SELECT AVG(hallazgos_por_usuario) AS promedio_hallazgos FROM ( SELECT COUNT(*) AS hallazgos_por_usuario FROM task t JOIN reported_by r ON t.id = r.task_id GROUP BY r.user_id)","9"
14,"Lista a quienes esten por debajo de ese numero pero que tengan al menos 1 hallazgo cargado","SELECT u.first_name, u.last_name FROM user u JOIN assigned_to a ON u.id = a.user_id JOIN reported_by r ON u.id = r.user_id JOIN task t ON r.task_id = t.id WHERE u.id < 1000 GROUP BY u.first_name, u.last_name HAVING COUNT(t.id) > 0 AND COUNT(t.id) < 3.12 ","9"
